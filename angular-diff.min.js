"use strict";angular.module("diff",[]).filter("diff",["$sce",function(r){function t(r){var t=r;return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&quot;")}function e(r,e){r=r.replace(/\s+$/,""),e=e.replace(/\s+$/,"");var l=n(""==r?[]:r.split(/\s+/),""==e?[]:e.split(/\s+/)),o="",u=r.match(/\s+/g);null==u?u=["\n"]:u.push("\n");var w=e.match(/\s+/g);if(null==w?w=["\n"]:w.push("\n"),0==l.n.length)for(var s=0;s<l.o.length;s++)o+="<del>"+t(l.o[s])+u[s]+"</del>";else{if(null==l.n[0].text)for(e=0;e<l.o.length&&null==l.o[e].text;e++)o+="<del>"+t(l.o[e])+u[e]+"</del>";for(var s=0;s<l.n.length;s++)if(null==l.n[s].text)o+="<ins>"+t(l.n[s])+w[s]+"</ins>";else{var a="";for(e=l.n[s].row+1;e<l.o.length&&null==l.o[e].text;e++)a+="<del>"+t(l.o[e])+u[e]+"</del>";o+=" "+l.n[s].text+w[s]+a}}return o}function n(r,t){for(var e=new Object,n=new Object,l=0;l<t.length;l++)null==e[t[l]]&&(e[t[l]]={rows:new Array,o:null}),e[t[l]].rows.push(l);for(var l=0;l<r.length;l++)null==n[r[l]]&&(n[r[l]]={rows:new Array,n:null}),n[r[l]].rows.push(l);for(var l in e)1==e[l].rows.length&&"undefined"!=typeof n[l]&&1==n[l].rows.length&&(t[e[l].rows[0]]={text:t[e[l].rows[0]],row:n[l].rows[0]},r[n[l].rows[0]]={text:r[n[l].rows[0]],row:e[l].rows[0]});for(var l=0;l<t.length-1;l++)null!=t[l].text&&null==t[l+1].text&&t[l].row+1<r.length&&null==r[t[l].row+1].text&&t[l+1]==r[t[l].row+1]&&(t[l+1]={text:t[l+1],row:t[l].row+1},r[t[l].row+1]={text:r[t[l].row+1],row:l+1});for(var l=t.length-1;l>0;l--)null!=t[l].text&&null==t[l-1].text&&t[l].row>0&&null==r[t[l].row-1].text&&t[l-1]==r[t[l].row-1]&&(t[l-1]={text:t[l-1],row:t[l].row-1},r[t[l].row-1]={text:r[t[l].row-1],row:l-1});return{o:r,n:t}}return function(t,n){return r.trustAsHtml(e(t,n))}}]);